import{F as M,r,j as e,C as l,Z as R,B as n,S as T}from"./index-BhnCGazT.js";import{M as z}from"./Modal-Bjrg86Tx.js";const F=({user:b})=>{const{logs:a}=M(),[d,k]=r.useState(""),[c,v]=r.useState("all"),[x,w]=r.useState("all"),[o,S]=r.useState("all"),[s,C]=r.useState(null),[A,g]=r.useState(!1),u=r.useMemo(()=>a.filter(t=>{const i=d===""||t.action.toLowerCase().includes(d.toLowerCase())||t.user.name.toLowerCase().includes(d.toLowerCase())||t.details.toLowerCase().includes(d.toLowerCase()),h=c==="all"||t.category===c,f=x==="all"||t.status===x;if(o!=="all"){const L=new Date(t.timestamp),E=new Date;if(o==="today")return i&&h&&f&&L.toDateString()===E.toDateString()}return i&&h&&f}),[a,d,c,x,o]),m=r.useMemo(()=>({total:a.length,success:a.filter(t=>t.status==="success").length,failures:a.filter(t=>t.status==="failure").length,warnings:a.filter(t=>t.status==="warning").length}),[a]);if(b.role!=="Admin")return e.jsx("div",{className:"flex items-center justify-center min-h-96",children:e.jsx(l,{variant:"bordered",className:"max-w-md text-center",children:e.jsxs("div",{className:"p-6",children:[e.jsx("span",{className:"text-5xl mb-4 block",children:"ðŸ”’"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Access Restricted"}),e.jsx("p",{className:"text-gray-500 dark:text-slate-400",children:"You don't have permission to view the audit log. Please contact your administrator."})]})})});const N=[{id:"all",label:"All Categories",icon:"ðŸ“‹"},{id:"user",label:"User Actions",icon:"ðŸ‘¤"},{id:"data",label:"Data Access",icon:"ðŸ“‚"},{id:"system",label:"System",icon:"âš™ï¸"},{id:"security",label:"Security",icon:"ðŸ”"},{id:"compliance",label:"Compliance",icon:"âœ…"},{id:"hr",label:"HR Actions",icon:"ðŸ‘¥"}],p=t=>{switch(t){case"success":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400";case"failure":return"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400";case"warning":return"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400";default:return"bg-gray-100 dark:bg-slate-700 text-gray-600 dark:text-slate-400"}},j=t=>{const i=N.find(h=>h.id===t);return(i==null?void 0:i.icon)||"ðŸ“‹"},D=t=>{C(t),g(!0)},y=t=>new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-slate-600 to-slate-800 rounded-xl text-white",children:e.jsx(R,{className:"w-6 h-6"})}),"Audit Log"]}),e.jsx("p",{className:"text-gray-500 dark:text-slate-400 mt-1",children:"System activity and compliance tracking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"secondary",children:"Export CSV"}),e.jsx(n,{children:"Generate Report"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(l,{variant:"glass",padding:"md",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:m.total}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Total Events"})]})}),e.jsx(l,{variant:"glass",padding:"md",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:m.success}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Successful"})]})}),e.jsx(l,{variant:"glass",padding:"md",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:m.failures}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Failures"})]})}),e.jsx(l,{variant:"glass",padding:"md",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400",children:m.warnings}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-slate-400",children:"Warnings"})]})})]}),e.jsx(l,{variant:"bordered",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Search logs...",value:d,onChange:t=>k(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-50 dark:bg-slate-800 rounded-xl text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-slate-500 outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsx("select",{value:c,onChange:t=>v(t.target.value),className:"px-4 py-2 bg-gray-50 dark:bg-slate-800 rounded-xl text-gray-900 dark:text-white outline-none focus:ring-2 focus:ring-indigo-500",children:N.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))}),e.jsxs("select",{value:x,onChange:t=>w(t.target.value),className:"px-4 py-2 bg-gray-50 dark:bg-slate-800 rounded-xl text-gray-900 dark:text-white outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failure",children:"Failure"}),e.jsx("option",{value:"warning",children:"Warning"})]}),e.jsxs("select",{value:o,onChange:t=>S(t.target.value),className:"px-4 py-2 bg-gray-50 dark:bg-slate-800 rounded-xl text-gray-900 dark:text-white outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"})]})]})}),e.jsxs(l,{variant:"bordered",padding:"none",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-slate-700 bg-gray-50 dark:bg-slate-800/50",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-600 dark:text-slate-400",children:"Timestamp"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-600 dark:text-slate-400",children:"User"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-600 dark:text-slate-400",children:"Action"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-600 dark:text-slate-400",children:"Category"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-600 dark:text-slate-400",children:"Status"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-600 dark:text-slate-400",children:"Details"})]})}),e.jsx("tbody",{children:u.map(t=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-slate-800 hover:bg-gray-50 dark:hover:bg-slate-800/50 cursor-pointer transition-colors",onClick:()=>D(t),children:[e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-sm text-gray-600 dark:text-slate-300",children:y(t.timestamp)})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-slate-700 flex items-center justify-center text-sm font-medium text-gray-600 dark:text-slate-300",children:t.user.name.charAt(0)}),e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:t.user.name})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:t.action})}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-slate-300",children:[e.jsx("span",{children:j(t.category)}),e.jsx("span",{className:"capitalize",children:t.category})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full capitalize ${p(t.status)}`,children:t.status})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-sm text-gray-500 dark:text-slate-400 truncate max-w-xs block",children:t.details})})]},t.id))})]})}),u.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("span",{className:"text-4xl mb-4 block",children:"ðŸ”"}),e.jsx("p",{className:"text-gray-500 dark:text-slate-400",children:"No audit logs match your filters."})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 dark:border-slate-700",children:[e.jsxs("span",{className:"text-sm text-gray-500 dark:text-slate-400",children:["Showing ",u.length," entries"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"secondary",size:"sm",disabled:!0,children:"Previous"}),e.jsx(n,{variant:"secondary",size:"sm",disabled:!0,children:"Next"})]})]})]}),e.jsxs(l,{variant:"glass",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Real-time Activity"}),e.jsxs("span",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Live"]})]}),e.jsx("div",{className:"space-y-3",children:a.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"text-xl",children:j(t.category)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm text-gray-900 dark:text-white truncate",children:[e.jsx("span",{className:"font-medium",children:t.user.name})," - ",t.action]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400",children:y(t.timestamp)})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${p(t.status)}`,children:t.status})]},t.id))})]}),e.jsx(z,{isOpen:A,onClose:()=>g(!1),title:"Audit Log Details",size:"md",children:s&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-slate-800 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-3xl",children:j(s.category)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:s.action}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${p(s.status)}`,children:s.status})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mb-1",children:"Timestamp"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:y(s.timestamp)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mb-1",children:"User"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:s.user.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mb-1",children:"Category"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white capitalize",children:s.category})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mb-1",children:"IP Address"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white font-mono",children:s.ipAddress})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mb-1",children:"Details"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:s.details})]}),s.affectedEntity&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-slate-400 mb-1",children:"Affected Entity"}),e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:s.affectedEntity})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t border-gray-200 dark:border-slate-700",children:[e.jsx(n,{variant:"secondary",className:"flex-1",onClick:()=>g(!1),children:"Close"}),e.jsx(n,{className:"flex-1",children:"Export Entry"})]})]})})]})};export{F as default};
